#!/bin/bash
# create_file_lists.sh - Script to create file lists for each directory

# Define your base directories
DIRECTORIES=(
    "/eos/user/r/rpramani/run3/2023/data_era_C/EGamma0/EGamma0_Run2023C_22Sep2023_v1_v1_1/250821_233349/0000"
    "/eos/user/r/rpramani/run3/2023/data_era_C/EGamma0/EGamma0_Run2023C_22Sep2023_v1_v1_1/250821_233349/0001"
    "/eos/user/r/rpramani/run3/2023/data_era_C/EGamma0/EGamma0_Run2023C_22Sep2023_v2_v1_2/250820_005751/0000"
    "/eos/user/r/rpramani/run3/2023/data_era_C/EGamma0/EGamma0_Run2023C_22Sep2023_v3_v1_3/250820_005234/0000"
    "/eos/user/r/rpramani/run3/2023/data_era_C/EGamma0/EGamma0_Run2023C_22Sep2023_v4_v1_4/250820_100615/0000"
    "/eos/user/r/rpramani/run3/2023/data_era_C/EGamma0/EGamma0_Run2023C_22Sep2023_v4_v1_4/250820_100615/0001"
    "/eos/user/r/rpramani/run3/2023/data_era_C/EGamma0/EGamma0_Run2023C_22Sep2023_v4_v1_4/250820_100615/0002"
    "/eos/user/r/rpramani/run3/2023/data_era_C/EGamma0/EGamma0_Run2023C_22Sep2023_v4_v1_4/250820_100615/0003"
)

# Create output directory for file lists
mkdir -p filelists_ZG

# Function to create file list for each directory
create_file_list() {
    local dir=$1
    local index=$2
    
    echo "Creating file list for directory $index: $dir"
    
    # Extract a meaningful name for the file list
    local dirname=$(basename $(dirname $(dirname $dir)))
    local subdir=$(basename $dir)
    local filename="filelists_ZG/filelist_${dirname}_${subdir}_job${index}.txt"
    
    # Find all ROOT files and write to file list
    find $dir -name "*.root" -type f > $filename
    
    # Count files
    local file_count=$(wc -l < $filename)
    echo "Found $file_count ROOT files in $dir"
    echo "File list saved as: $filename"
    
    echo $filename
}

# Create file lists for each directory
echo "Creating file lists for Condor jobs..."
job_index=0

for dir in "${DIRECTORIES[@]}"; do
    if [ -d "$dir" ]; then
        create_file_list "$dir" $job_index
        ((job_index++))
    else
        echo "Warning: Directory does not exist: $dir"
    fi
done

